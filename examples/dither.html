<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><style type="text/css">/* Copyright 2019 Google LLC                              */
/*                                                        */
/* Use of this source code is governed by a BSD-style     */
/* license that can be found in the LICENSE file or at    */
/* https://developers.google.com/open-source/licenses/bsd */

body {
  font-family: Helvetica, sans-serif;
  font-size: 100%;
  color: #333;
  display: flex;
  justify-content: space-between;
  overflow-x: hidden;

  --main-width: 50rem;
  --nav-width: 20rem;
}

@media (max-width: 70rem) {
    /*For narrow screens hide nav and enable horizontal scrolling */
    nav {display: none;}
    body {overflow-x: auto;}
}

nav {/* this actually just holds space for #navbar, which is fixed */
  min-width: var(--nav-width);
  max-width: var(--nav-width);
}
#navbar {
  position: fixed;
  height: 100vh;
  width: var(--nav-width);
  overflow-y: scroll;
  border-right: 1px solid firebrick;
}
#navbar:before {
  content: "Contents";
  font-weight: bold;
}
nav ol {
  list-style-type:none;
  padding-left: 1rem;
}

#main-output {
  max-width: var(--main-width);
  margin: auto;
}

.cell {
}

.code-block, .err-block, .result-block {
  padding: 0em 0em 0em 2em;
  display: block;
  font-family: monospace;
  white-space: pre;
}

code {
  background-color: #F0F0F0;
}

.result-block {
  border-left: 3px solid  #87CEFA;
}

.prose-block {
  line-height: 140%;
}

.err-block {
  font-weight: bold;
  color: #B22222;
  border-left: 3px solid #B22222;
}

.plot {
  padding: 5em;
}

.plot-img {
  width: 80%;
}

.comment {
  color: #808080;
}

.keyword {
  color: #0000DD;
}

.command {
  color: #A80000;
}

.symbol {
  color: #E07000;
}

.type-name {
  color: #A80000;
}

.iso-sugar {
  color: #25BBA7;
}
</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" onload="// Copyright 2019 Google LLC
//
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file or at
// https://developers.google.com/open-source/licenses/bsd

var katexOptions = {
    delimiters: [
        {left: &quot;$$&quot;, right: &quot;$$&quot;, display: true},
        {left: &quot;\\[&quot;, right: &quot;\\]&quot;, display: true},
        {left: &quot;$&quot;, right: &quot;$&quot;, display: false},
        {left: &quot;\\(&quot;, right: &quot;\\)&quot;, display: false}
    ],
    // Enable commands that load resources or change HTML attributes
    // (e.g. hyperlinks): https://katex.org/docs/security.html.
    trust: true
};

var cells = {};

function append_contents(key, contents) {
    if (key in cells) {
        var cur_cells = cells[key];
    } else {
        var cell = document.createElement(&quot;div&quot;);
        cell.className = &quot;cell&quot;;
        cells[key] = [cell];
        var cur_cells = [cell];
    }
    for (var i = 0; i &lt; contents.length; i++) {
        for (var j = 0; j &lt; cur_cells.length; j++) {
            var node = lookup_address(cur_cells[j], contents[i][0])
            node.innerHTML += contents[i][1];
        }
    }
}

function lookup_address(cell, address) {
    var node = cell
    for (i = 0; i &lt; address.length; i++) {
        node = node.children[address[i]]
    }
    return node
}

function renderLaTeX() {
    // Render LaTeX equations in prose blocks via KaTeX, if available.
    // Skip rendering if KaTeX is unavailable.
    if (typeof renderMathInElement == &#39;undefined&#39;) {
        return;
    }
    // Render LaTeX equations in prose blocks via KaTeX.
    var proseBlocks = document.querySelectorAll(&quot;.prose-block&quot;);
    Array.from(proseBlocks).map((proseBlock) =&gt;
        renderMathInElement(proseBlock, katexOptions)
    );
}

/**
 * Rendering the Table of Contents / Navigation Bar
 * 2 key functions
 *  - `updateNavigation()` which inserts/updates the navigation bar
 *  - and it&#39;s helper `extractStructure()` which extracts the structure of the page
 *    and adds ids to heading elements.
*/
function updateNavigation() {
    function navItemList(struct) {
        var listEle = document.createElement(&#39;ol&#39;)
        struct.children.forEach(childStruct=&gt;
            listEle.appendChild(navItem(childStruct))
        );
        return listEle;
    }
    function navItem(struct) {
        var a = document.createElement(&#39;a&#39;);
        a.appendChild(document.createTextNode(struct.text));
        a.title = struct.text;
        a.href = &quot;#&quot;+struct.id;

        var ele = document.createElement(&#39;li&#39;)
        ele.appendChild(a)
        ele.appendChild(navItemList(struct));
        return ele;
    }

    var navbarEle = document.getElementById(&quot;navbar&quot;)
    if (navbarEle === null) {  // create it
        navbarEle = document.createElement(&quot;div&quot;);
        navbarEle.id=&quot;navbar&quot;;
        navOuterEle = document.createElement(&quot;nav&quot;)
        navOuterEle.appendChild(navbarEle);
        document.body.prepend(navOuterEle);
    }

    navbarEle.innerHTML = &quot;&quot;
    var structure = extractStructure()
    navbarEle.appendChild(navItemList(structure));
}

function extractStructure() { // Also sets ids on h1,h2,...
    var headingsNodes = document.querySelectorAll(&quot;h1, h2, h3, h4, h5, h6&quot;);
    // For now we are just fulling going to regenerate the structure each time
    // Might be better if we made minimal changes, but ðŸ¤·

    // Extract the structure of the document
    var structure = {children:[]}
    var active = [structure.children];
    headingsNodes.forEach(
        function(currentValue, currentIndex) {
            currentValue.id = &quot;s-&quot; + currentIndex;
            var currentLevel = parseInt(currentValue.nodeName[1]);

            // Insert dummy levels up for any levels that are skipped
            for (var i=active.length; i &lt; currentLevel; i++) {
                var dummy = {id: &quot;&quot;, text: &quot;&quot;, children: []}
                active.push(dummy.children);
                var parentList = active[i-1]
                parentList.push(dummy);
            }
            // delete this level and everything after
            active.splice(currentLevel, active.length);

            var currentStructure = {
                id: currentValue.id,
                text: currentValue.textContent,
                children: [],
            };
            active.push(currentStructure.children);

            var parentList = active[active.length-2]
            parentList.push(currentStructure);
        },
    );
    return structure;
}

/**
 * HTML rendering mode.
 * Static rendering is used for static HTML pages.
 * Dynamic rendering is used for dynamic HTML pages via `dex web`.
 *
 * @enum {string}
 */
var RENDER_MODE = Object.freeze({
  STATIC: &quot;static&quot;,
  DYNAMIC: &quot;dynamic&quot;,
})

/**
 * Renders the webpage.
 * @param {RENDER_MODE} renderMode The render mode, either static or dynamic.
 */
function render(renderMode) {
    if (renderMode == RENDER_MODE.STATIC) {
        // For static pages, simply call rendering functions once.
        renderLaTeX();
        updateNavigation();
    } else {
        // For dynamic pages (via `dex web`), listen to update events.
        var source = new EventSource(&quot;/getnext&quot;);
        source.onmessage = function(event) {
            var body = document.getElementById(&quot;main-output&quot;);
            var msg = JSON.parse(event.data);
            if (msg == &quot;start&quot;) {
                body.innerHTML = &quot;&quot;;
                cells = {}
                return
            }
            var order    = msg[0];
            var contents = msg[1];
            for (var i = 0; i &lt; contents.length; i++) {
                append_contents(contents[i][0], contents[i][1]);
            }
            if (order != null) {
                var new_cells = {};
                body.innerHTML = &quot;&quot;;
                for (var i = 0; i &lt; order.val.length; i++) {
                    var key = order.val[i]
                    var cur_cells = cells[key]
                    if (cur_cells.length == 0) {
                        var cur_cell = new_cells[key][0].cloneNode(true)
                    } else {
                        var cur_cell = cur_cells.pop()
                        if (key in new_cells) {
                            new_cells[key].push(cur_cell);
                        } else {
                            new_cells[key] = [cur_cell];
                        }
                    }
                    body.appendChild(cur_cell);
                }
                Object.assign(cells, new_cells);
            }
            renderLaTeX();
            updateNavigation();
        };
    }
}
render(RENDER_MODE.STATIC);"></script></head><body><div id="main-output"><div class="cell"><div class="code-block"></div></div><div class="cell"><div class="prose-block"><h1>Dither.dx</h1>
<p>&quot;A common use of dither is converting a grayscale image to black and white,
such that the density of black dots in the new image approximates
the average gray level in the original.&quot;
[From <a href="https://en.wikipedia.org/wiki/Dither">https://en.wikipedia.org/wiki/Dither</a>]</p>
</div></div><div class="cell"><div class="prose-block"><p>Here we represent grayscale images as matrices of floats with continuous
values between 0 (white) and 1 (black). The quantized results after dithering
will be matrices of booleans arising from a pixel-wise thresholding.
Each dithering algorithm below uses its own rule of choosing a threshold value,
resulting in distinct styles.</p>
</div></div><div class="cell"><div class="code-block"><span class="keyword">import</span> plot
</div></div><div class="cell"><div class="code-block"><span class="keyword">import</span> png
</div></div><div class="cell"><div class="code-block"><span class="keyword">import</span> netpbm
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h1>Round 0: Creating a test image</h1>
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> bmatshow(mat<span class="symbol">:</span> h<span class="symbol">=&gt;</span>w<span class="symbol">=&gt;</span><span class="type-name">Bool</span>) <span class="symbol">-&gt;</span> <span class="type-name">Html</span> <span class="keyword">given</span> (h<span class="symbol">|</span><span class="type-name">Ix</span><span class="symbol">,</span> w<span class="symbol">|</span><span class="type-name">Ix</span>) <span class="symbol">=</span>
  matshow <span class="keyword">for</span> i j<span class="symbol">.</span> b_to_f mat[i<span class="symbol">,</span> j]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="type-name">Height</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 100
</div></div><div class="cell"><div class="code-block"><span class="type-name">Width</span> <span class="symbol">=</span> <span class="type-name">Fin</span> 300
</div></div><div class="cell"><div class="code-block">key <span class="symbol">=</span> new_key 1234
</div></div><div class="cell"><div class="code-block">img_ <span class="symbol">=</span> <span class="keyword">for</span> i<span class="symbol">:</span><span class="type-name">Height</span><span class="symbol">.</span> <span class="keyword">for</span> j<span class="symbol">:</span><span class="type-name">Width</span><span class="symbol">.</span> n_to_f ((ordinal i) <span class="symbol">+</span> (ordinal j))
</div></div><div class="cell"><div class="code-block">img <span class="symbol">=</span> img_ <span class="symbol">/</span> (n_to_f (size <span class="type-name">Height</span> <span class="symbol">+</span> size <span class="type-name">Width</span>))
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:t</span> img
</div><div class="result-block">((Fin 100) =&gt; (Fin 300) =&gt; Float32)</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> matshow img
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAASwAAABkCAIAAACzY5qXAAAAAXNSR0IArs4c6QAABH9JREFUeJztnMtu40AMBC3//0fvIcBikc3DsjRkF6cugQ4Cq7pPAmLyeDwej8fjOI6Pvz88/PrC62/eOKoFqv+G0IX+o8LQRulPgS71B/fSAtV/Q+hq/+ekMKBR+lOgBf7PSWEoo/SnQGv8n5PCIEbpT4GW+X/7OUoMkz9Kfwq00v/rz1FomPBR+lOgxf5ffI5ywySP0p8Crff//DmKDhM7Sn8KtMX/eert8DCZo/SnQLv8n4vmtoQJHKU/Bdro/5wUJm2U/hRor/9P/yfEhYkapT8F2u7/+8/WQGFyRulPgSb4//KzNVaYkFH6U6Ah/i99jlLCJIzSnwLN8b9hiyInTPso/SnQKP+rWxRRYfQXSvS/tEWRFkZ/oUT/97coAsPoL5To/+YWRWYY/YUS/d/ZoogNo79Qov/pLYrkMPoLJfqf26IID6O/UKL/iS2K/DD6CyX6v7pFgQijv1Ci/z0/WwsJo79Qon/p8d+WBvXfEMryrzv+WxBGf6FE/6LjvzVh9BdK9K84/tvSoP4bQqH+y4//VobRf2co13/t8d/iMPpvC0X7Lzz+29Kg/htC6f6rjv+2hNF/Q+gA/yXHf7vC6L8bdIb//cd/G8NwoXR/S7sy6ubjv71hoFC6v6VdHHXn8d/2MEQo3d/Sro+67fhvQhgclO5vabeMqt6iyBylPwU60r90iyJzlP4U6FT/ui2KzFH6U6CD/Yu2KDJH6U+Bzvav2KLIHKU/BTref/kWReYo/SnQHfzXblFkjtKfAt3Ef+EWReYo/SnQffxXbVFkjtKfAt3Kf8kWReYo/SnQ3fzv36LIHKU/Bbqh/81bFJmj9KdA9/S/c4sic5T+FOi2/rdtUSSECYHS/S2teNQ9WxQhYRKgdH9Lqx91wxZFTph2KN3f0lpGXd2iiAqjPw6q/3FxiyItjP4sqP4fD+9vUQSG0R8E1f/vw5tbFJlh9KdA9f/34Z0titgw+iOg+n96OL1FkRyGO2ofqP7/P5zboggPAx21D1T/L988sUWRH4Y4ah+o/t+9+eoWBSIMbtQ+UP1/eBN8/LcFSve3tEB/6vHfFijd39Iy/ZHHf1ugdH9Li/XnHf9tgdL9LS3ZH3b8twVK97e0cH/S8d8WKN3f0vL9Mcd/W6B0f0tD+DOO/7ZA6f6WRvEHHP9tgdL9LQ3kn378twVK97c0ln/08d8WKN3f0nD+ucd/W6B0f0sj+oce/22B0v0tDeqfePy3BUr3tzSuf9zx3xYo3d/S0P5Zx39boHR/S6P7Bx3/bYHS/S1tgH/K8d8WKN3f0mb4Rxz/bYHS/S1tjH//8d8WKN3f0ib5Nx//bYHS/S1tmH/n8d8WKN3f0ub5tx3/bYHS/S1tpH/P8d8WKN3f0qb6Nxz/bWmQ7m9pg/2rj/8uDTPV39Jm+5ce/21pkO5vaeP9647/FoSZ529pO/gXHf+tCTPM39I28a84/tvSIN3f0vbxX378tzLMGH9L28p/7fHf4jAz/C1tN/+Fx39bGqT7W9qG/quO/7aEoftb2ob+x3H8Aa9j4gLLGsH4AAAAAElFTkSuQmCC"></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h1>Round 1: Threshold dithering</h1>
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> dither_threshold(img<span class="symbol">:</span> h<span class="symbol">=&gt;</span>w<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">-&gt;</span> (h<span class="symbol">=&gt;</span>w<span class="symbol">=&gt;</span><span class="type-name">Bool</span>) <span class="keyword">given</span> (h<span class="symbol">|</span><span class="type-name">Ix</span><span class="symbol">,</span> w<span class="symbol">|</span><span class="type-name">Ix</span>) <span class="symbol">=</span>
  <span class="keyword">for</span> i j<span class="symbol">.</span> img[i<span class="symbol">,</span> j] <span class="symbol">&gt;</span> 0<span class="symbol">.</span>5
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> bmatshow <span class="symbol">$</span> dither_threshold img
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAASwAAABkCAIAAACzY5qXAAAAAXNSR0IArs4c6QAAAkJJREFUeJzt00lyG0EMAEHq/4+mD3Z4kSlxplcAnfmCutTHA+Z4Pp+7E3L42B1ATQ68zoSM58BbTMhgDrzLhIzkwAYmZBgHtjEhYziwmQkZwIE9TEgvB3YyIV0c2M+EtHPgECakkQNHMSEtHDiQCbnNgWOZkHscOJwJucGBM5iQqxw4iQm5xIHzmJD3HDiVCXnDgbOZkO84cAET8iUHrmFCXnPgMibkBQeuZEI+c+BiJuQfDlzPhPzhwC1MyC8O3MWEPB4O3MqEOHAzE57OgduZ8GgOjMCE53JgECY8lAPjMOGJHBiKCY/jwGhMeBYHBmTCgzgwJhOewoFhmfAIDozMhPU5MDgTFufA+ExYmQNTMGFZDszChDU5MBETFuTAXExYjQPTMWEpDszIhHU4MCkTFuHAvExYgQNTM2F6DszOhLk5sAATJubAGkyYlQPLMGFKDqzEhPk4sBgTJuPAekyYiQNLMmEaDqzKhDk4sDATJuDA2kwYnQPLM2FoDjyBCeNy4CFMGJQDz2HCiBx4FBOG48DTmDAWBx7IhIE48EwmjMKBxzJhCA48mQn3c+DhTLiZAzHhTg7kYcKNHMhPJtzDgfxmwg0cyN9MuJoD+cSESzmQ/5lwHQfykgkXcSBfMeEKDuQbJpzOgXzPhHM5kLdMOJEDucKEsziQi0w4hQO5zoTjOZBbTDiYA7nLhCM5kAYmHMaBtDHhGA6kmQkHcCA9TNjLgXQyYRcH0s+E7RzIECZs5EBGMWELBzKQCW9zIGP9AJlQK0hL1AyZAAAAAElFTkSuQmCC"></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h1>Round 2: Noise dithering</h1>
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> dither_noise(k<span class="symbol">:</span><span class="type-name">Key</span><span class="symbol">,</span> img<span class="symbol">:</span> h<span class="symbol">=&gt;</span>w<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">-&gt;</span> (h<span class="symbol">=&gt;</span>w<span class="symbol">=&gt;</span><span class="type-name">Bool</span>) <span class="keyword">given</span> (h<span class="symbol">|</span><span class="type-name">Ix</span><span class="symbol">,</span> w<span class="symbol">|</span><span class="type-name">Ix</span>) <span class="symbol">=</span>
  <span class="keyword">for</span> i j<span class="symbol">.</span> img[i<span class="symbol">,</span> j] <span class="symbol">&gt;</span> rand (ixkey k (i<span class="symbol">,</span> j))
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> bmatshow <span class="symbol">$</span> dither_noise key img
</div><img class="plot-img" src="data:image/png;base64, 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"></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h1>Round 3: Ordered dithering</h1>
<p>Ordered dithering uses a small threshold matrix that is periodically tiled over the target
image. We achieve this by wrapping the pixel indices i and j into the range of
the small matrix <code>mat</code> to retrieve the threshold.</p>
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> dither_ordered(mat<span class="symbol">:</span> mh<span class="symbol">=&gt;</span>mw<span class="symbol">=&gt;</span><span class="type-name">Float</span><span class="symbol">,</span> img<span class="symbol">:</span> h<span class="symbol">=&gt;</span>w<span class="symbol">=&gt;</span><span class="type-name">Float</span>) <span class="symbol">-&gt;</span> (h<span class="symbol">=&gt;</span>w<span class="symbol">=&gt;</span><span class="type-name">Bool</span>) <span class="keyword">given</span> (mh<span class="symbol">|</span><span class="type-name">Ix</span><span class="symbol">,</span> mw<span class="symbol">|</span><span class="type-name">Ix</span><span class="symbol">,</span> h<span class="symbol">|</span><span class="type-name">Ix</span><span class="symbol">,</span> w<span class="symbol">|</span><span class="type-name">Ix</span>) <span class="symbol">=</span>
  <span class="keyword">for</span> i j<span class="symbol">.</span> img[i<span class="symbol">,</span> j] <span class="symbol">&gt;</span> mat[wrap_periodic mh (ordinal i)<span class="symbol">,</span> wrap_periodic mw (ordinal j)]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">bayer <span class="symbol">=</span> [[1<span class="symbol">.</span>0<span class="symbol">,</span>  9<span class="symbol">,</span>  3<span class="symbol">,</span> 11]<span class="symbol">,</span> 
         [ 13<span class="symbol">,</span>  5<span class="symbol">,</span> 15<span class="symbol">,</span>  7]<span class="symbol">,</span>
         [  4<span class="symbol">,</span> 12<span class="symbol">,</span>  2<span class="symbol">,</span> 10]<span class="symbol">,</span>
         [ 16<span class="symbol">,</span>  8<span class="symbol">,</span> 14<span class="symbol">,</span>  6]] <span class="symbol">/</span> 17<span class="symbol">.</span>0
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><p>This so-called Bayer matrix leads to the distinctive crosshatch pattern
that was frequently used in old video games with limited color palettes.</p>
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> bmatshow <span class="symbol">$</span> dither_ordered bayer img
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAASwAAABkCAIAAACzY5qXAAAAAXNSR0IArs4c6QAABCxJREFUeJztl0Fy2zAMAJn+/8/pAR4VTRrXtihyAe8ednZyigWKGowxic/PT2BruANCb2TIpeRHzGlNMwXOGc2t4Q4I/TJD4OQhcVpP9K9xAs6ZyN3MHx8fwD5jwv9PmOyX0ysz4dxHuTXZO+Gc0dwa7oDQUxgCJA+G0/oiP70Tcs5E7mYm7Evugcssc9h7B/3UuopXwzmjuTXcAaGnMwRCHgan9QI/tBNyzkTuZibsS+6BWyyvs+auebZ1CQdfJngtnDOaW8OdT+revpQhG8kD4LRe7B93Qs6ZyN3MhH3JPXC75Tnm3imzWpdw8L3HdXDOaG4N908ndX0vY8hi8kPntN7ov3ZCzpnI3cyEfck9EGX5P6/dHVe3LuHgfo+5cM5obg33Iyd1TW9hyALyg+a0hvgX50zkbmbCvuQeiLX8m/t3xK7WJRw83uM8nDOaW8P97Em9rrcz5CLyw+W0Bhq0EzYzYV9yDyxh+UN+IpzWJRy81uM1OGc0t4b7zEmd2yiGTCQ/UE5ruDfvhM1M2JfcA8v53clPgdO6hIPzPR6Hc0Zza7hnndTzjWXISfJD5LQu4WDDTtjMhH3JPbCo35f8+zmtSziY2+M+1525M63hnnU6z3cJhrxAfnCc1iV8vHhHL9oJm5mwL7kHFvX3d+Rd+On3721dwsF1Pb6T/8ppDfesE3m+yzHkQfLD4rQu4eNl+2dfuBM2M2Ffcg8s6vvvS2ce+f3rW5dwsKYvOWezWsM96xSe79IMuUN+QJzWJXy8YP/tyTthMxP2JffAon783enGs79/TesSDtb3JWfuTGu4Z528892GIV/ID4XTuoSPl+qpvm0Lx7xfaA13DIvQ0pY8Y07rEg729qlv4KzWcMewCC1tyTPmtC7h4Ezfbrtj9n67ejiGRWhpS54xp3UJB4QO3AO131LZRJ4xp3UJB7P6dvMd58BvV13HsAgtbckz5rQu4YDQ33EP1H5LZSF5xpzWJRxc0bdb8DgTfrtqOYZFaGlLnjGndQkHhL6Pe+C7O4ZFaGlLnjGndQkHV/ftRjzOB+Fu1n67ZDN5xpzWJRwQ+nHcA9/RMSxCS1vyjDmtSzhY2ftvZe23SxDkGXNal3BA6NdwD3wXx7AILW3JM+a0LuFgV++/obXfLtlGnjGndQkHhD6Pe2Bnx7AILW3JM+a0LuGA0Ptva+23S5aSZ8xpXcIBoefiHtjNMSxCS1vyjDmtSzggdGb/za3jZSa0tCXPmNO6hANCX4d7YAfHsAgtbckz5rQu4YDQP7H/Fn9Px8tMaGlLnjGndQkHhF6De2BVx7AILW3JM+a0LuGA0I+w/0Z/H8fLTGhpS54xp3UJB4Rej3tgJcewCC1tyTPmtC7hgNDPsv927+14mQktbckz5rQu4YDQe9n/rdB+S2Uzecac1iUcEPoMvwEdMPxibI1A0wAAAABJRU5ErkJggg=="></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block">halftone <span class="symbol">=</span> [[14<span class="symbol">.</span>0<span class="symbol">,</span>  10<span class="symbol">,</span>  6<span class="symbol">,</span> 13<span class="symbol">,</span> 19<span class="symbol">,</span> 23<span class="symbol">,</span> 27<span class="symbol">,</span> 20]<span class="symbol">,</span>
            [   7<span class="symbol">,</span>   2<span class="symbol">,</span>  1<span class="symbol">,</span>  9<span class="symbol">,</span> 26<span class="symbol">,</span> 31<span class="symbol">,</span> 32<span class="symbol">,</span> 24]<span class="symbol">,</span>
            [  11<span class="symbol">,</span>   3<span class="symbol">,</span>  4<span class="symbol">,</span>  5<span class="symbol">,</span> 22<span class="symbol">,</span> 30<span class="symbol">,</span> 29<span class="symbol">,</span> 28]<span class="symbol">,</span>
            [  15<span class="symbol">,</span>   8<span class="symbol">,</span> 12<span class="symbol">,</span> 16<span class="symbol">,</span> 18<span class="symbol">,</span> 25<span class="symbol">,</span> 21<span class="symbol">,</span> 17]<span class="symbol">,</span>
            [  19<span class="symbol">,</span>  23<span class="symbol">,</span> 27<span class="symbol">,</span> 20<span class="symbol">,</span> 14<span class="symbol">,</span> 10<span class="symbol">,</span>  6<span class="symbol">,</span> 13]<span class="symbol">,</span>
            [  26<span class="symbol">,</span>  31<span class="symbol">,</span> 32<span class="symbol">,</span> 24<span class="symbol">,</span>  7<span class="symbol">,</span>  2<span class="symbol">,</span>  1<span class="symbol">,</span>  9]<span class="symbol">,</span>
            [  22<span class="symbol">,</span>  30<span class="symbol">,</span> 29<span class="symbol">,</span> 28<span class="symbol">,</span> 11<span class="symbol">,</span>  3<span class="symbol">,</span>  4<span class="symbol">,</span>  5]<span class="symbol">,</span>
            [  18<span class="symbol">,</span>  25<span class="symbol">,</span> 21<span class="symbol">,</span> 17<span class="symbol">,</span> 15<span class="symbol">,</span>  8<span class="symbol">,</span> 12<span class="symbol">,</span> 16]] <span class="symbol">/</span> 33<span class="symbol">.</span>0
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><p>Such a &quot;halftone&quot; matrix imitates an <a href="https://en.wikipedia.org/wiki/Halftone">old printing technique for newspapers</a>:</p>
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> bmatshow <span class="symbol">$</span> dither_ordered halftone img
</div><img class="plot-img" src="data:image/png;base64, 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"></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="prose-block"><h1>Dithering a real image</h1>
</div></div><div class="cell"><div class="code-block"><span class="comment">-- conversion from RGB to grayscale
</span></div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> pixel(x<span class="symbol">:</span><span class="type-name">Char</span>) <span class="symbol">-&gt;</span> <span class="type-name">Float32</span> <span class="symbol">=</span>
  r <span class="symbol">=</span> w8_to_i x
  i_to_f <span class="keyword">case</span> r <span class="symbol">&lt;</span> 0 <span class="keyword">of</span>
    <span class="type-name">True</span> <span class="symbol">-&gt;</span> 256 <span class="symbol">+</span> r
    <span class="type-name">False</span> <span class="symbol">-&gt;</span> r
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> srgb_to_linear(c<span class="symbol">:</span> <span class="type-name">Float</span>) <span class="symbol">-&gt;</span> <span class="type-name">Float</span> <span class="symbol">=</span>
  <span class="keyword">case</span> c <span class="symbol">&lt;=</span> 0<span class="symbol">.</span>04045 <span class="keyword">of</span>
    <span class="type-name">True</span>  <span class="symbol">-&gt;</span> c <span class="symbol">/</span> 12<span class="symbol">.</span>92
    <span class="type-name">False</span> <span class="symbol">-&gt;</span> pow ((c <span class="symbol">+</span> 0<span class="symbol">.</span>055) <span class="symbol">/</span> 1<span class="symbol">.</span>055) 2<span class="symbol">.</span>4
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> linear_to_srgb(c<span class="symbol">:</span> <span class="type-name">Float</span>) <span class="symbol">-&gt;</span> <span class="type-name">Float</span> <span class="symbol">=</span> 
  <span class="keyword">case</span> c <span class="symbol">&lt;=</span> 0<span class="symbol">.</span>0031308 <span class="keyword">of</span>
    <span class="type-name">True</span>  <span class="symbol">-&gt;</span> c <span class="symbol">*</span> 12<span class="symbol">.</span>92
    <span class="type-name">False</span> <span class="symbol">-&gt;</span> 1<span class="symbol">.</span>055 <span class="symbol">*</span> (pow c (1<span class="symbol">.</span>0 <span class="symbol">/</span> 2<span class="symbol">.</span>4)) <span class="symbol">-</span> 0<span class="symbol">.</span>055
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="keyword">def</span> rbg_to_gray(pix<span class="symbol">:</span> (<span class="type-name">Fin</span> 3)<span class="symbol">=&gt;</span><span class="type-name">Word8</span>) <span class="symbol">-&gt;</span> <span class="type-name">Float</span> <span class="symbol">=</span>
  vals <span class="symbol">=</span> <span class="keyword">for</span> c<span class="symbol">.</span> srgb_to_linear <span class="symbol">$</span> (pixel pix[c]) <span class="symbol">/</span> 255<span class="symbol">.</span>0
  linear_to_srgb <span class="symbol">$</span> vdot vals [0<span class="symbol">.</span>2126<span class="symbol">,</span> 0<span class="symbol">.</span>7152<span class="symbol">,</span> 0<span class="symbol">.</span>0722]
</div></div><div class="cell"><div class="code-block">

</div></div><div class="cell"><div class="prose-block"><p>To run this section, move the following .ppm image to examples</p>
</div></div><div class="cell"><div class="prose-block"><p><code>wget https://gist.github.com/niklasschmitz/03be29c2850ac3bbdf6ce86229b71d8f/raw/300962b117fe8595913fb1f35db546b53974576c/camera.ppm</code></p>
</div></div><div class="cell"><div class="code-block"><span class="type-name">MkImage</span>(rows<span class="symbol">,</span> cols<span class="symbol">,</span> img_camera_rgb) <span class="symbol">=</span> from_just <span class="symbol">$</span> load_image_p6 &quot;examples<span class="symbol">/</span>camera<span class="symbol">.</span>ppm&quot;
</div></div><div class="cell"><div class="code-block">img_camera <span class="symbol">=</span> <span class="keyword">for</span> i j<span class="symbol">.</span> rbg_to_gray img_camera_rgb[i<span class="symbol">,</span> j]
</div></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:t</span> img_camera
</div><div class="result-block">((Fin 427) =&gt; (Fin 640) =&gt; Float32)</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> matshow img_camera
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAoAAAAGrCAIAAADfLLEcAAAAAXNSR0IArs4c6QAABpRJREFUeJzt1TEBACAMwDDA+Kzjgh4kCvp1z8wCAN46dQAA/MiAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIHAB+koE0x45e1AAAAAASUVORK5CYII="></div><div class="cell"><div class="code-block">
</div></div><div class="cell"><div class="code-block"><span class="command">:html</span> bmatshow <span class="symbol">$</span> dither_threshold img_camera
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAoAAAAGrCAIAAADfLLEcAAAAAXNSR0IArs4c6QAABpRJREFUeJzt1TEBACAMwDDA+Kzjgh4kCvp1z8wCAN46dQAA/MiAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIHAB+koE0x45e1AAAAAASUVORK5CYII="></div><div class="cell"><div class="code-block"><span class="command">:html</span> bmatshow <span class="symbol">$</span> dither_noise key img_camera
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAoAAAAGrCAIAAADfLLEcAAAAAXNSR0IArs4c6QAABpRJREFUeJzt1TEBACAMwDDA+Kzjgh4kCvp1z8wCAN46dQAA/MiAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIHAB+koE0x45e1AAAAAASUVORK5CYII="></div><div class="cell"><div class="code-block"><span class="command">:html</span> bmatshow <span class="symbol">$</span> dither_ordered bayer img_camera
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAoAAAAGrCAIAAADfLLEcAAAAAXNSR0IArs4c6QAABpRJREFUeJzt1TEBACAMwDDA+Kzjgh4kCvp1z8wCAN46dQAA/MiAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIHAB+koE0x45e1AAAAAASUVORK5CYII="></div><div class="cell"><div class="code-block"><span class="command">:html</span> bmatshow <span class="symbol">$</span> dither_ordered halftone img_camera
</div><img class="plot-img" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAoAAAAGrCAIAAADfLLEcAAAAAXNSR0IArs4c6QAABpRJREFUeJzt1TEBACAMwDDA+Kzjgh4kCvp1z8wCAN46dQAA/MiAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIGDAABAwYAAIGDAABAwYAAIGDAABAwaAgAEDQMCAASBgwAAQMGAACBgwAAQMGAACBgwAAQMGgIABA0DAgAEgYMAAEDBgAAgYMAAEDBgAAgYMAAEDBoCAAQNAwIABIHAB+koE0x45e1AAAAAASUVORK5CYII="></div></div></body></html>